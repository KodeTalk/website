<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<!--
Design by Free CSS Templates
http://www.freecsstemplates.org
Released for free under a Creative Commons Attribution 2.5 License

Name       : ExtremeSurfing
Description: A two-column, fixed-width design with dark color scheme.
Version    : 1.0
Released   : 20120225

-->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="keywords" content="" />
<meta name="description" content="" />
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<title>Memanfaatkan Vbox Secara Out of the Box dengan Vagrant - Let&#039;s Talk About Code</title>
<link href="http://fonts.googleapis.com/css?family=Oswald" rel="stylesheet" type="text/css" />
<link href='http://fonts.googleapis.com/css?family=Arvo' rel='stylesheet' type='text/css'>
<link href="/css/style.css" rel="stylesheet" type="text/css" media="screen" />
</head>
<body>
<div id="wrapper">
  <div id="page">
    <div id="page-bgtop">
      <div id="page-bgbtm">
        <div id="page-content">
          <div id="header-wrapper">
            <div id="header">
              <div id="logo">
                <h1><a href="#">KodeTalk</a></h1>
                <p>Let&#039;s Talk About Code</p>
              </div>
            </div>
          </div>
          <!-- end #header -->
          <div id="menu-wrapper">
  <div id="menu">
    <ul>
              <li><a href="/index.html">Homepage</a></li>
              <li><a href="/tolkien.html">Tolkien</a></li>
          </ul>
  </div>
</div>
<!-- end #menu -->
<div id="banner"><img src="/images/banner.jpg" width="940" height="300" alt="" /></div>
          <div id="content">
            <div class="post">
	<h2 class="title"><a href="#">Memanfaatkan Vbox Secara Out of the Box dengan Vagrant</a></h2>
	<p class="meta">Posted by 
		<a href="#">Glend Maatita</a> on October 08, 2013 &nbsp;&bull;&nbsp;
				  <a href="/categories/Notes.html" class="permalink">Notes</a> 
	  		  <a href="/categories/Ruby.html" class="permalink">Ruby</a> 
	  	</p>
	<div class="entry">
		<p><img src="/images/vagrant.png" alt="Alt text" /></p>

<p><a href="http://www.vagrantup.com/">Vagrant</a> adalah sebuah tools yang dapat digunakan untuk membuat environment kerja yang portable dan distributable. Environment kerja yang dimaksud adalah OS beserta seluruh library dan software yang diperlukan agar seorang programmer dapat langsung melakukan tugasnya (baca: coding) tanpa harus repot men-setting environment kerja. Intinya, dengan Vagrantm anda akan dapat melakukan skenario seperti ini</p>

<p><em>Anda punya project yang akan dideploy ke server milik client anda yang sudah terinstall CentOS didalamnya. Anda ingin agar saat aplikasi telah di-deploy, tidak ada masalah yang berarti karena perbedaan environment. Server pakai CentOS dengan berbagai library yang spesifik, sedangkan tim developer anda memakai OS yang berbeda2. ada yang pake Windows, Mac, atau Ubuntu.</em></p>

<p><em>Hal ini akan mengakibatkan beberapa macam permasalahan. Misal, programmer A, si maniak Linux Slackware, telah menyelesaikan suatu <strong>fitur X</strong>, mengetest nya dan ternyata running well, kemudian me-push kode nya ke Git Repo. Kemudian programmer B, pengguna Windows, dengan polosnya melakukan pull ke Git Repo untuk mendapatkan update kode fitur terbaru dan ternyata fitur baru tersebut tidak berjalan. Setelah diselidiki, ternyata si programmer A telah menginstall beberapa library spesifik Slackware agar <strong>fitur X</strong> dapat berjalan</em>.Skenario diatas memang menjengkelkan, dan itu masih terjadi diantara para developer. Bagaimana ketika aplikasi sudah berjalan di server dengan OS yang berbeda lagi? Cara terbaik adalah menyamakan OS untuk development dengan server production</p>

<pre><code>Operating System untuk Development = Operating System Server Production
</code></pre>

<p>Tapi cara diatas tidak efektif. Pertama, masing-masing developer harus mensetting environment kerjanya terlebih dahulu. Ini buang-buang waktu, belum lagi jika ada developer yang baru masuk di tengah jalan. Kedua adalah, bagaimana jika developer tidak nyaman jika lingkungan kerjanya harus sesuai dengan server production.</p>

<p>Vagrant akan mengatasi permasalahan-permasalahan diatas. Dengan memanfaatkan vagrant, environment kerja dapat dibuat dan didistribusikan ke seluruh anggota tim project sehingga tim project tersebut akan mendapat banyak keuntungan, semisal :</p>

<ul>
<li><p>Programmer dapat langsung bekerja, tanpa perlu membuang waktu untuk men-setup komputernya agar siap digunakan. Jangan sepelekan masalah ini, walaupun kecil, waktu yang terbuang akan lumayan besar</p></li>
<li><p>Memastikan seluruh anggota tim project, terutama developer, mempunyai environment kerja yang sama persis. Pernah dengar celetukan seperti ini, <em>"Woy, di komputerku jalan kok, gak tau juga kalo di tempatmu gak jalan?"</em> . Tenang, Vagrant akan mengatasi masalah klasik ini. <em>Jadi,  semua programmer harus menggunakan OS yang sama dunk?</em> . Tidak. Vagrant menyediakan cara yang unik untuk ini dan akan kita bahas lebih lanjut. Intinya, kita tetap dapat bekerja dengan OS sehari-hari kita dan me-running aplikasi kita di virtual machine milik Vagrant secara <em>on the fly</em>.</p></li>
<li><p>Dapat digunakan sebagai staging server yang praktis</p></li>
</ul>

<p><strong>Instalasi</strong></p>

<p>Vagrant adalah sebuah rubygems. Untuk menginstallnya, pastikan anda telah mempunyai Ruby di komputer anda. Untuk menginstall Ruby, <a href="http://kodetalk.com/2013/10/05/setting-environment-untuk-ruby-development-part-1.html">simak artikel ini</a>. Selain itu, karena Vagrant menggunakan VBox sebagai virtual machine-nya, maka pastikan juga VBox telah terinstall di komputer anda. Anda dapat mendownload VBox secara free di <a href="https://www.virtualbox.org/wiki/Downloads">website resmi Oracle Virtual Box</a></p>

<p>Menginstall Vagrant</p>

<pre><code>~$ gem install vagrant
</code></pre>

<p><strong>Menambah vagrant box</strong></p>

<p>Step berikutnya adalah menginstall OS di VBox. Anda dapat memanfaatkan Vagrant Boxes untuk ini. Vagrant Boxes adalah <strong>template virtual machine</strong> yang dapat langsung digunakan oleh Vagrant. Anda dapat melihat list boxes yang tersedia dan mendownload boxes yang sekiranya cocok sebagai environment kerja anda <a href="http://www.vagrantbox.es/">disini</a>. Saya sendiri secara pribadi menggunakan <a href="http://files.vagrantup.com/precise32.box">Ubuntu Precise 32 Bit</a>. Silakan download dan letakkan boxes yang telah terdownload ke suatu directory, misal di <strong>/home/glend/precise32.box</strong>.</p>

<p>Selanjutnya tinggal menambahkan box tadi ke Vagrant dengan perintah <strong>vagrant add [nama box - sembarang nama] [lokasi box]</strong></p>

<pre><code>~$ vagrant box add precise32 /home/glend/precise32
[vagrant] Downloading with Vagrant::Downloaders::File...
[vagrant] Copying box to temporary location...
[vagrant] Extracting box...
[vagrant] Verifying box...
[vagrant] Cleaning up downloaded box...
</code></pre>

<p>Anda dapat menambah sebanyak mungkin box yang anda inginkan. Misal kita mempunyai beberapa project, Project A harus jalan di Debian, Project B harus bisa jalan di BSD, dsb, Vagrant akan membantu kita untuk memanage masing-masing environment kerja setiap project kita. Untuk melihat box apa saja yang telah kita tambahkan ke vagrant, simply run command below</p>

<pre><code>~$ vagrant box list
precise32
</code></pre>

<p><strong>Inisiasi Vagrant</strong></p>

<p>Oke, selanjutnya, saatnya kita gunakan vagrant. Buat suatu directory misal <em>vagrant-test</em>, atau kalau anda sudah mempunyai project yang akan memanfaatkan Vagrant ini, silakan menuju ke directory project anda. Saya sendiri sudah mempunyai directory yang berisi suatu project Rails yang terletak di <strong>/opt/sites/myrails</strong></p>

<pre><code>~$ cd /opt/sites/myrails
</code></pre>

<p>Initialize Vagrant di directory yang telah kita pilih tadi. <strong>Ingat</strong>, directory yang kita pilih tadi sekarang adalah directory tempat Vagrant berjalan. Directory tersebut akan dapat kita akses di dalam virtual machine (VM) milik Vagrant. <strong>Ya !!</strong>, itu adalah directory <em>sharing</em> antara komputer anda dengan VM milik vagrant, sehingga kita dapat menambah, mengubah, atau menghapus file melalui komputer kita atau melalui VM Vagrant :) .</p>

<p>Directory sharing inilah yang memungkinkan kita tetap mengerjakan aplikasi di OS sehari-hari kita (menambah file, mengubah kode, dll) dan me-running nya di virtual machine milik vagrant.</p>

<p>Untuk menginisiasi Vagrant, gunakan perintah</p>

<pre><code>~$ vagrant init precise32
create Vagrantfile
</code></pre>

<p><em>precise32</em> adalah nama box yang kita tambahkan sebelumnya. Saatnya untuk menjalanakn vagrant, jalan perintah dibawah ini untuk menjalankan vagrant</p>

<pre><code>~$ vagrant up
</code></pre>

<p>Perintah diatas akan menyalakan VM dan menjalankan vagrant. Jika vagrant sudah berjalan anda dapat langsung login ke dalam vagrant virtual machine dengan perintah</p>

<pre><code>~$ vagrant ssh
</code></pre>

<p>Sampai disini, anda telah masuk ke dalam VM dan mendapatkan akses yang sama seperti root. Selanjutnya anda dapat menginstall aplikasi dan seluruh library yang anda butuhkan untuk environment kerja anda seperti menginstall MySQL, apache, PHP, dsb. Setelah jadi, anda dapat mendistribusikan virtual machine ini dengan segala aplikasi yang sudah anda install tadi ke seluruh anggota tim project anda dengan melakukan perintah</p>

<pre><code>~$ vagrant package
</code></pre>

<p>Perintah diatas akan menghasilkan vagrant box dengan nama yang sama saat anda menambah box ke vagrant, dalam kasus diatas, perintah diatas akan membuat file bernama <strong>precise32.box</strong>.</p>

<p><strong>Port Forwarding</strong></p>

<p>Perintah init <strong>(vagrant init)</strong> diatas akan membuat sebuah file konfigurasi yang bernama <strong>Vagrantfile</strong>. Terdapat banyak konfigurasi yang dapat kita atur melalui file ini. Yang terpenting adalah <strong>port forwarding</strong>. Perhatikan konfigurasi port forwading yang terdapat di Vagrant file berikut ini</p>

<pre><code># Forward a port from the guest to the host, which allows for outside
# computers to access the VM, whereas host only networking does not.
config.vm.forward_port 80, 8080
</code></pre>

<p>Konfigurasi diatas akan memerintahkan Vagrant untuk memforward setiap request di port 80 pada komputer guest (komputer anda) ke virtual machine milik vagrant di port 8080.</p>

<p>Lalu, Apa fungsi port forwarding ini? Fungsi port forwarding ini melengkapi fungsi <strong>directory sharing</strong> diatas, yaitu agar kita dapat menjalankan aplikasi yang berjalan di VM Vagrant dan menampilkannya browser komputer anda. <em>Jadi browser kita hanya akan menampilkan output dari proses di aplikasi kita yang berjalan di VM vagrant!!</em></p>

<p>Jadi misalkan saya tadi sudah mempunyai project Rails, saya akan menjalankan webrick <strong>di dalam vagrant</strong>. Webrick berjalan di port 3000, sehingga saya akan mengubah konfigurasi port forwarding seperti ini</p>

<pre><code># Forward a port from the guest to the host, which allows for outside
# computers to access the VM, whereas host only networking does not.
config.vm.forward_port 3000, 3000
</code></pre>

<p>Konfigurasi diatas akan membuat vagrant meneruskan request aplikasi di port 3000 di komputer host ke port 3000 di VM vagrant. Selanjutnya, saya harus mereload vagrant setiap kali kita mengubah Vagrantfile</p>

<pre><code>~$ vagrant reload
</code></pre>

<p>Kemudian saya login ke vagrant dan menjalankan webrick</p>

<pre><code>~$ vagrant ssh
[vagrant]~$ rails s
</code></pre>

<p>Nah, dengan begitu, ketika kita mengarahkan browser ke <em>http://localhost:3000</em>, secara kasat mata, vagrant akan meneruskan request tadi untuk dijalankan di VM dan menampilkan outputnya ke browser kita.</p>

<p><strong>Memanfaatkan Vagrant sebagai server staging yang praktis</strong></p>

<p>Kita juga dapat memanfaatkan vagrant sebagai server staging. Kita dapat menyiapkan sebuah OS yang sama dengan production. Lalu dengan tools otomasi seperti <a href="http://www.capistranorb.com/">Capistrano</a>, kita jalankan otomasi mulai dari menginstall library yang diperlukan samapai menjalankan unit test. Jika semua berjalan, kita dapat mengembalikan server VM kita ke kondisi awal dengan perintah</p>

<pre><code>~$ vagrant destroy
</code></pre>

<p>Simple bukan?</p>

<p>Gunakan vagrant agar masalah klasik seperti "Di tempatku, aplikasi jalan baik, di tempatmu ya masalahmu" tidak terjadi di tim project kita.</p>

<p>Happy Coding :)</p>
 
	</div>
</div>
            <div style="clear: both;">&nbsp;</div>
          </div>
          <!-- end #content -->
          <div id="sidebar">
	<ul>
		<li>
			<h2>Situs apa sih ini?</h2>
			<p>KodeTalk adalah sebuah kumpulan tulisan seputar web development dan programming. Let's talk about code here.</p>
		</li>
		<li>
			<h2>Kategori</h2>
			<ul>
					      	<li><a href="/categories/Notes.html">Notes</a></li>
	      	      	<li><a href="/categories/Programming.html">Programming</a></li>
	      	      	<li><a href="/categories/Ruby.html">Ruby</a></li>
	      			</ul>
		</li>							
	</ul>
</div>
<!-- end #sidebar -->        </div>
        <div style="clear: both;">&nbsp;</div>
      </div>
    </div>
  </div>
  <!-- end #page -->
</div>
<div id="footer">
	<p>Copyright (c) 2012 KodeTalk.com. All rights reserved. Design by <a href="http://www.freecsstemplates.org/"> CSS Templates</a>.</p>
</div><!-- end #footer -->
</body>
</html>
